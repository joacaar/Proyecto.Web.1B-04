<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie-edge">

    <title>Mapa de sensores</title>

    <link rel="stylesheet" type="text/css" href="css/header.css">
    <link rel="stylesheet" type="text/css" href="css/mapa.css">
    <link rel="stylesheet" type="text/css" href="css/footer.css">
    <link rel="stylesheet" type="text/css" href="css/navbar.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
</head>

<body>
    <!--Cabecera-->
    <header>
        <div class="cabezal">
            <div class="logo"><a href="index.html"><img src="images/logo_GTI_azul.png" alt="Logo GTI" class="logo"></a></div>
            <!--<button type="button" id="Login" class="botonEnlace" onclick="location.href='login.html'">Iniciar sesión</button>-->
            <!--<a href="index.html" id="atras"><img src="images/" alt="Volver atrás"></a>-->
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
                    <img src="images/menu.svg" alt="menú">
                </button>
        </div>

        <!-- Menú -->
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                <ul class="navbar-nav mr-auto mt-2 mt-md-0">
                    <li class="nav-item active">
                        <a class="nav-link" href="mapa.html">Mapa <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="campo.html">Campos</a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <div class="dropdown">
        <button class="botonDropdown btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Lista de campos </button>
        <div class="dropdown-menu" id="dropdown" aria-labelledby="dropdownMenu1">
        </div>
    </div>

    <!--<input type="submit" class="croqueta" onclick="addDropdownLink(39, -0.16)" value="Crea links haciendo clock">-->

    <div id="map">
    </div>

    <!--
    <input type="submit" onclick="addZone([{lat:39, lng: -0.16},{...},{...}])">
    <input type="submit" onclick="addMarker(39, -0.16, 'aaaaah')">
-->
    <!--
    <script>
        //Script para el mapeado
        //mapa global
        var map;
        var zona;

        function initMap() {
            // var Nombre = { lat: X, lng: X}

            var Gandia = {
                lat: 38.997482,
                lng: -0.172141
            }

            map = new google.maps.Map(document.getElementById('map'), {
                zoom: 16,
                center: Gandia,
                disableDefaultUI: true,
                mapTypeId: google.maps.MapTypeId.SATELLITE
            });

            var puntos = [{
                    lat: 38.997805,
                    lng: -0.172096,
                    nombre: "Patatas"
                },
                {
                    lat: 38.997702,
                    lng: -0.171823,
                    nombre: "Tomates"
                },
                {
                    lat: 38.997102,
                    lng: -0.172567,
                    nombre: "Plátanos"
                }
            ];
            var losVertices = [{
                    lat: 38.996905,
                    lng: -0.172952
                },
                {
                    lat: 38.996629,
                    lng: -0.172181
                },
                {
                    lat: 38.997990,
                    lng: -0.171552
                },
                {
                    lat: 38.998127,
                    lng: -0.171987
                }

            ];

            for (var i = 0; i <= 2; i++) {
                addMarker(puntos[i].lat, puntos[i].lng, puntos[i].nombre);
            }

            addZone(losVertices);


            /*
            Punto = new google.maps.Marker({
                position: Gandia,
                map: map,
                title: "Pizzeria Volare",
                draggable: false
            })
            */

            //funcion al hacer click en el marcador
            //            Volare.addListener('click', function() {
            //                map.setZoom(32);
            //                map.setCenter(Volare.getPosition());
            //            })
        }

        function centerMap(nombreZona) {
            var textoSQL = '';

            //x1 más baja
            //y1 más baja
            //x2 más alta
            //y2 más alta
            var center = {}
            center.x = x1 + ((x2 - x1) / 2);
            center.y = y1 + ((y2 - y1) / 2);

            map.center(center);
        }

        //------------------------------------------//
        //-----Crear marcador, util para poner marcadores nuevos-----//
        function addMarker(lat, lng, nombreSensor) {
            /*if (ObjetoNombre.outerHTML){
                nombre = ObjetoNombre.outerHTML;
            } else if(XMLSerializer) {
                nombre = new XMLSerializer().serializeToString(ObjetoNombre);
            }*/
            //console.log(nombre);

            var location = {
                lat: lat,
                lng: lng
            }

            var marcador = new google.maps.Marker({
                position: location,
                map: map,
                title: nombreSensor,
                draggable: false
            });

            // string para introducir código HTML en InfoWindow
            var contentString = '<div id="Contenido">' + '<img src="#" alt="Temperatura" id="Gota">' + '<div id="Temperatura"> Temperatura ºC: </div>' + '<p id="Datos">25</p>' + '</div>' + '<div id="Contenido">' + '<img src="#" alt="Humedad" id="Gota">' + '<div id="Humedad"> Humedad %: </div>' + '<p id="Datos">20</p>' + '<a href="/graficas.html">Ver Grafica</a>' + '</div>';

            //Funcion para mostrar informacion
            var ventanaInfo = new google.maps.InfoWindow({
                content: contentString
            });

            marcador.addListener('click', function() {
                ventanaInfo.open(map, marcador)
            })
        }

        // Funcion para crear zonas
        function addZone(listaVertices) {

            zona = new google.maps.Polygon({
                paths: listaVertices,
                map: map,
                fillColor: '#fff',
                strokeColor: '#fff',
            })
        }


        function centerMap(lat, lng) {
            var newCenter = new google.maps.LatLng(lat, lng);
            map.panTo(newCenter);
        }

        //FALTA POR HACER QUE SE PUEDAN BORRAR
        function addDropdownLink(lat, lng) {
            var link = document.createElement('a');
            var X = 1;
            link.innerHTML = 'Campo' + ' ' + X
            link.className = 'dropdown-item';
            //link.href = '#!'; //sustituir por centrar mapa
            //link.onclick = 'centerMap(lat, lng)';
            link.addEventListener("click", () => centerMap(lat, lng))
            document.getElementById("dropdown").appendChild(link);
        }



        // var puntos = [
        //   { lat: 38.999,
        //     lng: -0.1629338,
        //     nombre: "Patatas"
        //   },
        //   { lat: 38.995,
        //     lng: -0.1629338
        //     nombre: "Tomates"
        //   },
        //   { lat: 38.997,
        //     lng: -0.1629338,
        //     nombre: "Plátanos"
        //   }
        // ];

        // }
        // for(var i = 0; i <= 2; i++){
        //   addMarker(puntos[i].lat, puntos[i].lng, puntos[i].nombre);
        // }

        /*
        //////////main()////////
        var vertices = [{
                lat: 39,
                lng: -0.16
            }, {
                lat: 39.3,
                lng: -0.17
            }, {
                lat: 39.7,
                lng: -0.18
            }, {
                lat: 39,
                lng: -0.18
            }, {
                lat: 39.4,
                lng: -0.15
            }
        ];
        */

        /*
        function editZone() {
            var botonGuardar = document.getElementById('Guardar')

            zona.setEditable(true);

            botonGuardar.style.display = 'block';
        }

        function noEditZone() {
            var botonGuardar = document.getElementById('Guardar')

            zona.setEditable(false);

            botonGuardar.style.display = 'none';
        }
        */

        /*
        function testMarcador() {
            var lat = parseFloat(document.getElementById('LatMarcador').value);
            var lng = parseFloat(document.getElementById('LngMarcador').value);

            marcador = new google.maps.LatLng(lat, lng);
            addMarker(marcador, "Sin Nombre De Momento")
        }
        */

        /*
        function moverMarcador() {
            var lat = parseFloat(document.getElementById('LatMarcador').value);
            var lng = parseFloat(document.getElementById('LngMarcador').value);

            var latlngNuevo = new google.maps.LatLng(lat, lng);
            Punto.setPosition(latlngNuevo);
        }
        */

        // var NombrePunto = new.google.maps.Marker({ position: Nombre, map: map})

        //var NombreZona = new google.maps.Polygon({
        //     paths: [{
        //         lat: 39,
        //         lng: -0.3
        //     },
        //     {
        //         lat: 39,
        //         lng: -0.0
        //     },
        //     {
        //         lat: 38.8,
        //         lng: -0.0
        //     },
        //     {
        //         lat: 38.8,
        //         lng: -0.3
        //     }],
        //     map: map, //mapa en el que está
        //     editable: true, //si se puede editar
        //     fillColor: "#00ff00", //color de relleno
        //     strokeColor: "#00ff00" //color de borde
        //});

        //var limites = new google.maps.LatLngBounds();
        //zona.getPath().getArray().forEach(function(vertice) {
        //    limites.extend(vertice);
        //});
        //map.fitBounds(limites);
    </script>
-->
    <script src="js/mapa.js"></script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPONQfQzjp3cGzsMLPscR9651VjXkL8AY&callback=initMap"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
